FROM openeuler/openeuler-binary-base:queens-20.03-lts-sp2

RUN yum -y install avahi-libs cups-libs fontconfig fontpackages-filesystem freetype gnutls initscripts iproute libjpeg-turbo libpng libX11 libX11-common libXau libxcb libXext libXi libxslt libyaml mailcap MySQL-python openssl python2-pyOpenSSL pyparsing python2-crypto python2-msgpack python2-cryptography python2-debtcollector python2-eventlet python2-fasteners python2-funcsigs python2-futurist python2-greenlet python2-iso8601 python2-oslo-cache python2-oslo-concurrency python2-oslo-config python2-oslo-context python2-oslo-db python2-oslo-i18n python2-oslo-log python2-oslo-messaging python2-oslo-middleware python2-oslo-policy python2-oslo-reports python2-oslo-rootwrap python2-oslo-serialization python2-oslo-service python2-oslo-utils python2-oslo-versionedobjects python2-pika python2-pika-pool python2-pyasn1 python2-PyMySQL python2-sysv-ipc python2-zake python2-alembic python2-amqp python2-barbicanclient python2-beaker python2-cachetools python2-cffi python2-cliff python2-cmd2 python2-contextlib2 python2-dateutil python2-decorator python2-designateclient python2-dogpile-cache python2-editor python2-enum34 python2-extras python2-fixtures python2-futures python2-glanceclient python2-heatclient python2-httplib2 python2-idna python2-inotify python2-ipaddress python2-ironicclient python2-jsonpatch python2-jsonpointer python2-jsonschema python2-kazoo python2-keyring python2-keystoneauth1 python2-keystoneclient python2-keystonemiddleware python2-kombu python2-linecache2 python2-logutils python2-lxml python2-mako python2-memcached python2-sqlalchemy-migrate python2-mimeparse python2-mistralclient python2-monotonic python2-netaddr python2-netifaces python2-neutronclient python2-novaclient python2-openstackclient python2-osprofiler python2-paramiko python2-paste python2-paste-deploy python2-pbr python2-ply python2-prettytable python2-psycopg2 python2-pycparser python2-PyMySQL python2-redis python2-repoze-lru python2-requests python2-retrying python2-routes python2-simplejson python2-sqlalchemy python2-sqlparse python2-stevedore python2-swiftclient python2-tempita python2-testtools python2-tooz python2-traceback2 python2-troveclient python2-unicodecsv python2-unittest2 python2-urllib3 python2-warlock python2-webob python2-wrapt PyYAML systemd-sysv tcp_wrappers-libs && yum clean all && rm -rf /var/cache/yum

RUN printf "[dn]\nCN=localhost\n[req]\ndistinguished_name = dn\n[EXT]\nsubjectAltName=DNS:localhost\nkeyUsage=digitalSignature\nextendedKeyUsage=serverAuth" | \
       openssl req -x509 -out /etc/pki/tls/certs/localhost.crt -keyout /etc/pki/tls/private/localhost.key \
       -newkey rsa:2048 -nodes -sha256 -subj '/CN=localhost' -extensions EXT -config - \
    && chmod 644 /etc/pki/tls/certs/localhost.crt /etc/pki/tls/private/localhost.key

